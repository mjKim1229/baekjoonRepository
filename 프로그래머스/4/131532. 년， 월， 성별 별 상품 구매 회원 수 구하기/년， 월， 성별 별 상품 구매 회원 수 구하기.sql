-- 코드를 입력하세요

#GENDER 0 : 남자, 1: 여자 , 비어있음 (NULL)
#년, 월, 성별 별 상품을 구매한 회원수 (DISTINCT)
#어쩔 수 없이 성별 끌어와야해서 JOIN필요 => ONLINE_SALE에는 USER_ID가 여러가지 가능 => DISTINCT 
# 년, 월 , 성별 오름차순 
# 성별 없는 경우 제외 (IS NOT NULL)

SELECT YEAR(SALES_DATE) AS YEAR, MONTH(SALES_DATE) AS MONTH , GENDER, COUNT(DISTINCT USER_ID) AS USERS 
FROM USER_INFO INNER JOIN ONLINE_SALE
USING (USER_ID)
WHERE GENDER IS NOT NULL 
GROUP BY YEAR, MONTH , GENDER 
ORDER BY YEAR, MONTH, GENDER 

# SELECT YEAR(SALES_DATE) AS YEAR, MONTH(SALES_DATE) AS MONTH , GENDER, COUNT(DISTINCT(USER_ID)) AS USERS
# FROM USER_INFO  
# INNER JOIN ONLINE_SALE USING(USER_ID) 
# GROUP BY YEAR, MONTH, GENDER  
# HAVING GENDER is not null
# ORDER BY YEAR, MONTH, GENDER