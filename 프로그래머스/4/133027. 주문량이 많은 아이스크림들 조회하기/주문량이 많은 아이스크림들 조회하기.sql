-- 코드를 입력하세요
# SELECT FLAVOR
# FROM FIRST_HALF AS a 
# INNER JOIN
# (
#     SELECT FLAVOR , SUM(TOTAL_ORDER) AS JULY_SUM
#     FROM JULY
#     GROUP BY FLAVOR
# ) AS b 
# USING(FLAVOR)  
# ORDER BY (TOTAL_ORDER + JULY_SUM) DESC 
# LIMIT 3 

#상반기 => JULY (shipment_id)
#July => 상반기 (FLAOVR)


SELECT FLAVOR 
FROM 
(
    SELECT FLAVOR, SUM(TOTAL_ORDER) AS JULY_TOTAL
    FROM JULY 
    GROUP BY FLAVOR
) AS JULY INNER JOIN FIRST_HALF
USING (FLAVOR)
ORDER BY JULY_TOTAL + TOTAL_ORDER DESC
LIMIT 3



